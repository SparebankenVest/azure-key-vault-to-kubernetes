package auth

import (
	"testing"

	"k8s.io/apimachinery/pkg/types"
)

var caCert = []byte(`-----BEGIN CERTIFICATE-----
MIIDYTCCAkmgAwIBAgIRAMVFSUuItvjfIauE8C6Px2EwDQYJKoZIhvcNAQELBQAw
TzEVMBMGA1UEChMMY2VydC1tYW5hZ2VyMTYwNAYDVQQDEy1jYS5henVyZS1rZXkt
dmF1bHQtdG8ta3ViZXJuZXRlcy5jZXJ0LW1hbmFnZXIwHhcNMjAxMDEwMDgyNjE3
WhcNMjUxMDA5MDgyNjE3WjBPMRUwEwYDVQQKEwxjZXJ0LW1hbmFnZXIxNjA0BgNV
BAMTLWNhLmF6dXJlLWtleS12YXVsdC10by1rdWJlcm5ldGVzLmNlcnQtbWFuYWdl
cjCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAKRhWMdyTVekaduaV4zs
tL3qmF0MJ/kxkGg07NftdSgg0fa31cMGlKmQdKOnsDmH4ZniKl7XX0cRq1R8nHTS
bJNhukphY2xwwfCHF428EdrvOqqXUE6tiJ0vf0C2hTIDzGYvUR8b3NczCuYReNDy
RDHw4Z+tTux8wtUB/Lvzrvy6A/Jp6tObAsWxuk6uFneblk+ukV5NCgq6WAtoCQGW
IMsMverczuTipFrUBruveYIN7shWEv0jaQBetUAojiR9tfUpM4e07svxZOd/uVm/
YQFBaczVuU4pA7RLWN3KwviR46sG9zSeUTn8wiKOmG94IrZQN0qDrXYnzegNk20H
W2kCAwEAAaM4MDYwDgYDVR0PAQH/BAQDAgKkMBMGA1UdJQQMMAoGCCsGAQUFBwMB
MA8GA1UdEwEB/wQFMAMBAf8wDQYJKoZIhvcNAQELBQADggEBACMFfqNNfOaNYQRA
nymlHdB5vVMtCR6dLez8E93Nh+rZifzvdHEiom0JK1OrTqTkBboyl3aFleMpJYno
sNI10sbYZTy+AAkQ3GEuG6CKofltvf/GoaN/WY4BDO2bc9gmlGTNTZCS/bctOO9C
5OEk9q8BwfBje5QOjgCGFL6QtmxJHrdXHvfed79GhxWKggwdKbR6ZM6di/TG93rK
OP5m876o9+xuQ2qV+f2TMY4c/B05OMzj01yHs27F13dFdyuEDzib+zcQR84HtjVY
zQBk+teA64qVmrS1d5geAXlSfNmC/QQm7Yr2Q3OVRUvnFcgW+1fUopbbbfsLQ6TO
a4UbAEg=
-----END CERTIFICATE-----`)

var caKey = []byte(`-----BEGIN RSA PRIVATE KEY-----
MIIEpAIBAAKCAQEApGFYx3JNV6Rp25pXjOy0veqYXQwn+TGQaDTs1+11KCDR9rfV
wwaUqZB0o6ewOYfhmeIqXtdfRxGrVHycdNJsk2G6SmFjbHDB8IcXjbwR2u86qpdQ
Tq2InS9/QLaFMgPMZi9RHxvc1zMK5hF40PJEMfDhn61O7HzC1QH8u/Ou/LoD8mnq
05sCxbG6Tq4Wd5uWT66RXk0KCrpYC2gJAZYgywy96tzO5OKkWtQGu695gg3uyFYS
/SNpAF61QCiOJH219Skzh7Tuy/Fk53+5Wb9hAUFpzNW5TikDtEtY3crC+JHjqwb3
NJ5ROfzCIo6Yb3gitlA3SoOtdifN6A2TbQdbaQIDAQABAoIBAQCXkX834Eg6cMp/
B/CEa9o4Z7D30vakyrPZsjtU2oo1ZxXTBS1gd5fqRd2W7U8LrSQzLRxeeP5MXJl6
/K+S9FfTCcCpRuVTHyFkdFwef3SDSCTzGTSeZ1pZfWs7s1Bbjq8Q5b5KDfnyoAkD
nMam+0wwNGkGP9pPKrbHi96LO6V1N2GDIJ6XFpCbvejJDM+cXEw8DmD2BiU6Cslq
q3AOIHfNbqcDQGQVFRjFJwvximKZ0AvvF49UwoQSgZq5+FJXi+Em7ypzGlm9BwZW
uCWKQFllv269M8Zv/3l9ojuCTQAtYXfsFfh7z9EvwuvDTPQLpoYznIIRmej8Pg8I
lAGldbIRAoGBAMm+BEuGBUiZSylJYiTUGkWFlUeiwfJy9pOYpEYM3NWppmYZnNl0
F3iWtjfQNbE4z++N4pP+zDBmtbqmvKrMeGT41yjHKGMmQXvLElA0mr9hPA3lJZJO
k/28OKUNBVrFi3BX2JLcLge/g8FLCn0yt363tCuAUq4a6j8lVKWvc8+1AoGBANCW
85Nzb61phEP3JQaXUUXF+4+wvo36QqqFDcJut24FjVmGaZwBI5Fcn151X2Oe2Al1
ZfNZNi2V5132CXIw1mvCpA+UmgfSgTljIWV1L4dfMUACkekOFn04+tEuCGUTU22r
1y8KQUjQqUqhUBP3EwwXGe1WmQPWfTquzGxsVGVlAoGAQ5lwRv45dwImtUbpo/2O
cA064C4hXuQ2y24yXWah+NZH855ReGv2EWou1LTnyOKIinS4n26ZbP59lnWYcoLh
NLRNJFTXq6F9/8Uj9cwqrkYeoWlPFZ9O547STDv4t1nKR3KoF02//sillXdXpGwC
IGvd61WsXrqWE2Km4n3QCKECgYEAhVLGs0uIaR3VdZ+lYdYcE23dQdWlppf8PoO2
7LzZr5AK7dr068rqkgHSt4xsAP/JdBo+pNEzyOVUsgENvpgqpUwOkwrXfQJ2qFiN
Qw0o6OzWTOSXoI/pnfZqkoNKyFgW7jV039M9MS511obO6UP2P7cQUlwUh5h0CKsr
bG29b+UCgYAb6tUPKHEQEvWEONNEy66vBtTIJXxjZISoExk40eaV/kAtEchlGXey
IrepX5pgiugqVP5K+xYTIiQ28X3xstrq4sZHYXuO2yAVaILlVBp5/df/riRbymbQ
7vphGG+/JeJJ6sb2yw48kYfQBroTO49aaf+A3LjykrkL+qAecX331w==
-----END RSA PRIVATE KEY-----`)

func TestCreateClientCert(t *testing.T) {
	uid := types.UID("asdlkfjalsdjflj")
	clientCert, err := generateClientCert(uid, 24, caCert, caKey)
	if err != nil {
		t.Error(err)
	}
	if clientCert == nil {
		t.Fail()
	}

	if string(clientCert.CA) != string(caCert) {
		t.Fail()
	}

	t.Logf("ca: \n%s", clientCert.CA)
	t.Logf("cert: \n%s", clientCert.Crt)
	t.Logf("key: \n%s", clientCert.Key)
}
